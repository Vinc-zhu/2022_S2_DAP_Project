subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_line(aes(incidence_rate_per_100000), linetype = "dashed",  size = 3) +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank())
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_line(aes(mean(incidence_rate_per_100000)), linetype = "dashed",  size = 3) +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank())
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
mean(incidence_rate_per_100000)
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_line(aes(mean(summary_incidence_by_state$incidence_rate_per_100000)), linetype = "dashed",  size = 3) +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank())
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_line(aes(64), linetype = "dashed",  size = 3) +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank())
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_segment(aes(y=incidence_rate_per_100000,
color="red",
size = 4))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_segment(aes(y=mean(summary_incidence_by_state$incidence_rate_per_100000),
color="red",
size = 4))
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_segment(aes(y=64,
color="red",
size = 4))
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_segment(aes(y=mean_value,
color="red",
size = 4))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
?geom_vline
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_vline(xintercept = 100)
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_hline(xintercept = 100)
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_hline(yintercept = 100)
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_hline(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000))
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_hline(yintercept = mean(incidence_rate_per_100000))
mean(summary_incidence_by_state$incidence_rate_per_100000)
summary_incidence_by_state
summary_incidence_by_state
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000), color = "White"))+
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000), color = "White"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000), color = "red"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000), colour = "red"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000), colour = "white"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000), color = "white"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000, color = "white"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(yintercept = mean(summary_incidence_by_state$incidence_rate_per_100000, size = 10, color = "white"))
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 5, col="red")
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 5, col="white")
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 1, col="red")
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 2, col="red")
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 5, col="red")
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 5, col="red")
ggplot_incidence <- summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 5, col="red")
ggplot_incidence + labs(title = "Incidence rate",
subtitle = "i.e. age_adjusted_incidence_rate_cases_per_100_000")
mean(summary_incidence_by_state$incidence_rate_per_100000)
ggplot_income <- summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state)) +
geom_col(show.legend = F) +
theme_economist() +
# theme(axis.text.x=element_blank(),
#       axis.title.y=element_blank()) +
geom_text(aes(label = state, y = incidence_rate_per_100000/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(incidence_rate_per_100000)), linetype = 5, col="red")
ggplot_income + labs(title = "Median income fot the whole population",
subtitle = "i.e. income_001")
summary_median_income_by_state
ggplot_income <- summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state)) +
geom_col(show.legend = F) +
theme_economist() +
# theme(axis.text.x=element_blank(),
#       axis.title.y=element_blank()) +
geom_text(aes(label = state, y = median_income_by_state/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(median_income_by_state)), linetype = 5, col="red")
ggplot_income + labs(title = "Median income fot the whole population",
subtitle = "i.e. income_001")
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
ggplot_income + labs(title = "Median income fot the whole population",
subtitle = "i.e. income_001")
ggplot_income + labs(title = "Median income fot the whole population",
subtitle = "i.e. income_001")
ggplot_income <- summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = median_income_by_state/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(median_income_by_state)), linetype = 5, col="red")
ggplot_income <- summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = median_income_by_state/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(median_income_by_state)), linetype = 5, col="red")
ggplot_income + labs(title = "Median income fot the whole population",
subtitle = "i.e. income_001")
median_income_by_statesummary_median_income_by_state$
0
summary_median_income_by_state$median_income_by_state
mean(summary_median_income_by_state$median_income_by_state)
ggplot_without_health_ins <- summary_without_health_ins_per_capita_by_state %>%
ggplot(aes(state, without_health_ins_per_capita)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = without_health_ins_per_capita/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(without_health_ins_per_capita)), linetype = 5, col="red")
ggplot_without_health_ins + labs(title = "Total without health insurance per capita ",
subtitle = " i.e. sum of the population without health insurance coverage for each age group / total population")
mean(summary_without_health_ins_per_capita_by_state$without_health_ins_per_capita)
ggplot_poverty_level <- summary_below_poverty_level_per_capita_by_state %>%
ggplot(aes(state, below_poverty_level_per_capita)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = below_poverty_level_per_capita/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(below_poverty_level_per_capita)), linetype = 5, col="red")
ggplot_poverty_level + labs(title = "Total below poverty line per capita",
subtitle = " i.e. total population below poverty level / total population")
mean(summary_below_poverty_level_per_capita_by_state$below_poverty_level_per_capita)
# Median income - income_001
# Check median income by State (assume the average income is similar to the median income)
summary_median_income_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(median_income_by_state = sum(income_001*popestimate2015) / sum(popestimate2015) )
ggplot_income <- summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state)) +
geom_col(show.legend = F) +
theme_economist() +
theme(axis.text.x=element_blank(),
axis.title.y=element_blank()) +
geom_text(aes(label = state, y = median_income_by_state/2), size = 4.5, color = "white") +
geom_hline(aes(yintercept=mean(median_income_by_state)), linetype = 5, col="red")
ggplot_income + labs(title = "Median income fot the whole population",
subtitle = "i.e. income_001")
knitr::opts_chunk$set(echo = TRUE)
# Installing libraries
# install.packages("simputation")
library(tidyverse)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggthemes)
# theme_economist()
# theme_fivethirtyeight()
# theme_bw()
library("corrplot")
library(janitor) # to clean column names
library(psych)   # for the describe function
library("stringr") # to add leading zeros
library(naniar) # to check missing values
library(simputation) # to replaces NAs
Boston.lmfit3<-lm(medv ~.,Boston) #regression wrt all covariates in dataframe
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
plot(joined_data_all_final_LRM)
joined_data_all_final_LRM
plot(joined_data_all_final_LRM[, 5:12])
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
plot(joined_data_all_final_LRM[, 5:12])
joined_data_all_final_LRM[, 5:12]
Boston.lmfit3<-lm(stroke_mort ~. , joined_data_all_final_LRM[, 5:12]) # regression wrt all covariates in dataframe
summary(Boston.lmfit3)
fit1 <-lm(stroke_mort ~. , joined_data_all_final_LRM[, 5:12]) # regression wrt all covariates in dataframe
summary(fit1)
summary(fit1)
fit1 <-lm(stroke_mort ~. , joined_data_all_final_LRM[, 5:12]) # regression wrt all covariates in dataframe
summary(fit1)
par(mfrow=c(2,2))
plot(fit1) #4 plots of various things for linear fit
fit2 <-lm(stroke_mort ~. - incidence_falling , joined_data_all_final_LRM[, 5:12])
summary(fit2)
par(mfrow=c(2,2))
plot(fit2) # 4 plots of various things for linear fit
fit3 <-lm(stroke_mort ~. - incidence_falling - incidence_rising, joined_data_all_final_LRM[, 5:12])
summary(fit3)
par(mfrow=c(2,2))
plot(fit3) # 4 plots of various things for linear fit
fit4 <-lm(stroke_mort ~. - incidence_falling - incidence_rising - population, joined_data_all_final_LRM[, 5:12])
summary(fit4)
par(mfrow=c(2,2))
plot(fit4)
fit_final <-  fit4
fit_final <-  fit4
par(mfrow=c(2,2))
plot(fit_final) # 4 plots of various things for linear fit
fit4 <-lm(stroke_mort ~. - incidence_falling - incidence_rising - population, joined_data_all_final_LRM[, 5:12])
summary(fit4)
fit5=update(fit3,~.- incidence_falling - incidence_rising - population)
summary(fit5)
median_income.values <- seq(10000, 100000, length = 10000)
predicted_values <- predict(fit_final, data.frame(median_income=median_income.values),interval="confidence")
median_income.values <- seq(10000, 100000, length = 10000)
predicted_values <- predict(fit_final, data.frame(median_income=median_income.values),interval="confidence")
knitr::opts_chunk$set(echo = TRUE)
# Installing libraries
# install.packages("simputation")
library(tidyverse)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggthemes)
# theme_economist()
# theme_fivethirtyeight()
# theme_bw()
library("corrplot")
library(janitor) # to clean column names
library(psych)   # for the describe function
library("stringr") # to add leading zeros
library(naniar) # to check missing values
library(simputation) # to replaces NAs
fit1 <-lm(stroke_mort ~. , joined_data_all_final_LRM[, 5:12]) # regression wrt all covariates in dataframe
summary(fit1)
fit2 <-lm(stroke_mort ~. - incidence_falling , joined_data_all_final_LRM[, 5:12])
summary(fit2)
fit3 <-lm(stroke_mort ~. - incidence_falling - incidence_rising, joined_data_all_final_LRM[, 5:12])
summary(fit3)
fit4 <-lm(stroke_mort ~. - incidence_falling - incidence_rising - population, joined_data_all_final_LRM[, 5:12])
# OR
# fit4 = update(fit3,~.- incidence_falling - incidence_rising - population)
summary(fit4)
fit5 = update(fit5,~.- incidence_falling - incidence_rising - population - median_income )
summary(fit5)
fit5 = update(fit4,~.- incidence_falling - incidence_rising - population - median_income )
summary(fit5)
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"), title="test")
corrplot(cor(joined_data_all_final_LRM[, 5:12]), title="test")
, use="pairwise.complete.obs"
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"), title="test")
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
plot(joined_data_all_final_LRM[, 5:12])
plot(joined_data_all_final_LRM[, 5:12], size = 10)
?plot
plot(joined_data_all_final_LRM[, 5:12], lwd = 10)
plot(joined_data_all_final_LRM[, 5:12], lwd = 1)
plot(joined_data_all_final_LRM[, 5:12], lwd = 3)
plot(joined_data_all_final_LRM[, 5:12])
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
plot(joined_data_all_final_LRM[, 5:12])
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
plot(joined_data_all_final_LRM[, 5:12])
fit1 <-lm(stroke_mort ~. , joined_data_all_final_LRM[, 5:12]) # regression wrt all covariates in dataframe
summary(fit1)
fit2 <-lm(stroke_mort ~. - incidence_rising   , joined_data_all_final_LRM[, 5:12])
summary(fit2)
fit3 <-lm(stroke_mort ~. - incidence_falling - incidence_rising, joined_data_all_final_LRM[, 5:12])
summary(fit3)
