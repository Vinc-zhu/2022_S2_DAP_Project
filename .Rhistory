summary_below_poverty_level_per_capita_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(below_poverty_level_per_capita = sum(poverty_002) / sum(popestimate2015) )
summary_below_poverty_level_per_capita_by_state %>%
ggplot(aes(state, below_poverty_level_per_capita, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
# Total without health insurance
joined_data_all_final <- joined_data_all_final %>%
mutate(total_without_health_ins =
hi_005 + hi_008 + hi_011 + hi_014 + hi_017 + hi_020 + hi_023 + hi_026 + hi_029 +
hi_033 + hi_036 + hi_039 + hi_042 + hi_045 + hi_048 + hi_051 + hi_054 + hi_057)
# Total without health insurance per capita
joined_data_all_final <- joined_data_all_final %>% mutate(total_without_health_ins_per_capita = total_without_health_ins / popestimate2015)
# Check min, max
describe(joined_data_all_final$total_without_health_ins_per_capita)
# joined_data_all %>% filter(total_without_health_ins_per_capita>=1) %>%
#   select(fips_clean, state, total_without_health_ins, total_without_health_ins_per_capita, popestimate2015)
#
# joined_data_all %>% filter(is.na(state)) %>%
#   select(fips_clean, state, total_without_health_ins, total_without_health_ins_per_capita, popestimate2015)
summary_without_health_ins_per_capita_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(without_health_ins_per_capita = sum(total_without_health_ins) / sum(popestimate2015) )
summary_without_health_ins_per_capita_by_state %>%
ggplot(aes(state, without_health_ins_per_capita, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
# Median income - income_001
# Check median income by State (assume the average income is similar to the median income)
summary_median_income_by_state <- joined_data_all %>%
group_by(state) %>%
summarise(median_income_by_state = sum(income_001*popestimate2015) / sum(popestimate2015) )
summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
#================ NA in income_001 for one TX country
# a_test <- joined_data_all %>%
#   mutate(income_pop = income_001*popestimate2015)
#
#
# a_test %>% group_by(state) %>%
#   summarise(median_income_by_state = sum(income_pop) / sum(popestimate2015) ) %>%
#   ggplot(aes(state, median_income_by_state, fill = state), na.rm = T) +
#   geom_col(show.legend = F) +
#   theme_economist()
#
# a_test %>% filter(state == "TX") %>%
#     select(fips_clean, state, income_001, popestimate2015, income_pop)
#
# a_test %>% filter(is.na(income_001))
summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
# Median income - income_001
# Check median income by State (assume the average income is similar to the median income)
summary_median_income_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(median_income_by_state = sum(income_001*popestimate2015) / sum(popestimate2015) )
summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
#================ NA in income_001 for one TX country
# a_test <- joined_data_all_final %>%
#   mutate(income_pop = income_001*popestimate2015)
#
#
# a_test %>% group_by(state) %>%
#   summarise(median_income_by_state = sum(income_pop) / sum(popestimate2015) ) %>%
#   ggplot(aes(state, median_income_by_state, fill = state), na.rm = T) +
#   geom_col(show.legend = F) +
#   theme_economist()
#
# a_test %>% filter(state == "TX") %>%
#     select(fips_clean, state, income_001, popestimate2015, income_pop)
#
# a_test %>% filter(is.na(income_001))
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
# joined_data_all_final %>%
#   mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
#   group_by(state) %>%
#   summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
# joined_data_all_final %>%
#   mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
#   group_by(state) %>%
#   summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
# joined_data_all_final %>%
#   mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
#   group_by(state) %>%
#   summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state), na.rm = T) +
geom_col(show.legend = F) +
theme_economist()
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
# joined_data_all_final %>%
#   mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
#   group_by(state) %>%
#   summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Median income - income_001
# Check median income by State (assume the average income is similar to the median income)
summary_median_income_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(median_income_by_state = sum(income_001*popestimate2015) / sum(popestimate2015) )
summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Total without health insurance
joined_data_all_final <- joined_data_all_final %>%
mutate(total_without_health_ins =
hi_005 + hi_008 + hi_011 + hi_014 + hi_017 + hi_020 + hi_023 + hi_026 + hi_029 +
hi_033 + hi_036 + hi_039 + hi_042 + hi_045 + hi_048 + hi_051 + hi_054 + hi_057)
# Total without health insurance per capita
joined_data_all_final <- joined_data_all_final %>% mutate(total_without_health_ins_per_capita = total_without_health_ins / popestimate2015)
# Check min, max
describe(joined_data_all_final$total_without_health_ins_per_capita)
# joined_data_all %>% filter(total_without_health_ins_per_capita>=1) %>%
#   select(fips_clean, state, total_without_health_ins, total_without_health_ins_per_capita, popestimate2015)
#
# joined_data_all %>% filter(is.na(state)) %>%
#   select(fips_clean, state, total_without_health_ins, total_without_health_ins_per_capita, popestimate2015)
summary_without_health_ins_per_capita_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(without_health_ins_per_capita = sum(total_without_health_ins) / sum(popestimate2015) )
summary_without_health_ins_per_capita_by_state %>%
ggplot(aes(state, without_health_ins_per_capita, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Total below poverty level per capita
joined_data_all_final <- joined_data_all_final %>% mutate(total_below_poverty_level_per_capita = poverty_002 / popestimate2015)
# Check min, max
describe(joined_data_all_final$total_below_poverty_level_per_capita)
summary_below_poverty_level_per_capita_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(below_poverty_level_per_capita = sum(poverty_002) / sum(popestimate2015) )
summary_below_poverty_level_per_capita_by_state %>%
ggplot(aes(state, below_poverty_level_per_capita, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
summary_incidence_by_state
joined_data_all_final %>%
mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
group_by(state) %>%
summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
joined_data_all_final %>% filter(state == "KS")
joined_data_all_final %>% filter(state %in% c("KS", "MN", "NV")
joined_data_all_final %>% filter(state %in% c("KS", "MN", "NV"))
joined_data_all_final %>% filter(state %in% c("KS", "MN", "NV"))
joined_data_all_final %>%
mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
group_by(state) %>%
summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Check Nevada Data
joined_data_all_final %>% filter(state == "NV")
joined_data_all_final %>% filter(state %in% c("KS", "MN", "NV"))
data_death_state4 %>% filter(state_name == "Nevada")
data_incidence_clean2 %>% filter(state_name == "Nevada")
data_incidence_clean2 %>% filter(grepl('Nevada', state_name))
data_incidence_clean2 %>% dplyr::filter(grepl('Nevada', state_name))
data_incidence_clean2
data_incidence_clean2 %>% dplyr::filter(grepl('Nevada', county))
data_incidence_clean2 %>% filter(grepl('Nevada', county))
data_incidence_clean2 %>% filter(grepl('Minnesota', county))
# Remove Nevada Data
joined_data_all_y_no_us_income_no_nevada <- joined_data_all_y_no_us_income %>% filter(state_name != "Nevada")
# Replace those NA incidence rate and average_annual_count with 0
joined_data_all_final <- joined_data_all_y_no_us_income_no_nevada %>%
impute_const(age_adjusted_incidence_rate_cases_per_100_000~0) %>%
impute_const(average_annual_count~0)
miss_var_summary(joined_data_all_final) # no more NAs
# Total below poverty level per capita
joined_data_all_final <- joined_data_all_final %>% mutate(total_below_poverty_level_per_capita = poverty_002 / popestimate2015)
# Check min, max
describe(joined_data_all_final$total_below_poverty_level_per_capita)
summary_below_poverty_level_per_capita_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(below_poverty_level_per_capita = sum(poverty_002) / sum(popestimate2015) )
summary_below_poverty_level_per_capita_by_state %>%
ggplot(aes(state, below_poverty_level_per_capita, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Total without health insurance
joined_data_all_final <- joined_data_all_final %>%
mutate(total_without_health_ins =
hi_005 + hi_008 + hi_011 + hi_014 + hi_017 + hi_020 + hi_023 + hi_026 + hi_029 +
hi_033 + hi_036 + hi_039 + hi_042 + hi_045 + hi_048 + hi_051 + hi_054 + hi_057)
# Total without health insurance per capita
joined_data_all_final <- joined_data_all_final %>% mutate(total_without_health_ins_per_capita = total_without_health_ins / popestimate2015)
# Check min, max
describe(joined_data_all_final$total_without_health_ins_per_capita)
# joined_data_all %>% filter(total_without_health_ins_per_capita>=1) %>%
#   select(fips_clean, state, total_without_health_ins, total_without_health_ins_per_capita, popestimate2015)
#
# joined_data_all %>% filter(is.na(state)) %>%
#   select(fips_clean, state, total_without_health_ins, total_without_health_ins_per_capita, popestimate2015)
summary_without_health_ins_per_capita_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(without_health_ins_per_capita = sum(total_without_health_ins) / sum(popestimate2015) )
summary_without_health_ins_per_capita_by_state %>%
ggplot(aes(state, without_health_ins_per_capita, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Median income - income_001
# Check median income by State (assume the average income is similar to the median income)
summary_median_income_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(median_income_by_state = sum(income_001*popestimate2015) / sum(popestimate2015) )
summary_median_income_by_state %>%
ggplot(aes(state, median_income_by_state, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
joined_data_all_final %>%
mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
group_by(state) %>%
summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
joined_data_all_final %>% filter(state %in% c("KS", "MN", "NV"))
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
joined_data_all_final %>% filter(state %in% c("KS", "MN"))
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe()
joined_data_all_final %>%
mutate(check = average_annual_count / popestimate2015 * 100000 - age_adjusted_incidence_rate_cases_per_100_000) %>%
group_by(state) %>%
summarise(sum(check), sum(average_annual_count), sum(age_adjusted_incidence_rate_cases_per_100_000), sum(popestimate2015) )
joined_data_all_final
# Zero for KS and MN, check
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe() # Incidence data is missing for KS and MN
joined_data_all_final %>% filter(state !%in% c("KS", "MN"))
joined_data_all_final %>% filter(state %in% -c("KS", "MN"))
joined_data_all_final %>% filter(state %!in% c("KS", "MN"))
joined_data_all_final %>% filter(state %nin% c("KS", "MN"))
joined_data_all_final %>% filter(!state %in% c("KS", "MN"))
joined_data_all_final <- joined_data_all_final %>% filter(!state %in% c("KS", "MN"))
# Zero for KS and MN, check
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe() # Incidence data is missing for KS and MN
# Zero for KS and MN, check
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe() # Incidence data is missing for KS and MN
joined_data_all_final
# Zero for KS and MN, check
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe() # Incidence data is missing for KS and MN
joined_data_all_final %>% filter(state %in% c("KS", "MN"))
knitr::opts_chunk$set(echo = TRUE)
# Installing libraries
# install.packages("simputation")
library(tidyverse)
library(readr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggthemes)
# theme_economist()
# theme_fivethirtyeight()
# theme_bw()
library(janitor) # to clean column names
library(psych)   # for the describe function
library("stringr") # to add leading zeros
library(naniar) # to check missing values
library(simputation) # to replaces NAs
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Zero for KS and MN, check
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe() # Incidence data is missing for KS and MN
# Remove Ks and MN rows
joined_data_all_final <- joined_data_all_final %>% filter(!state %in% c("KS", "MN"))
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# for numeric variables [TBD]
corrplot(cor(joined_data_all_final[, 13:44], use="pairwise.complete.obs"))
library("corrplot")
# for numeric variables [TBD]
corrplot(cor(joined_data_all_final[, 13:44], use="pairwise.complete.obs"))
# The advantage of faceting compared to grid.arrange() below is that it keeps the axes fixed across all plots, easing comparisons between plots.
# for numeric variables [TBD]
corrplot(cor(joined_data_all_final[, 13:44], use="pairwise.complete.obs"))
names(joined_data_all_final)
# The final dataset for modelling purpose
joined_data_all_final_LRM %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015)
# The final dataset for modelling purpose
joined_data_all_final_LRM <- joined_data_all_final %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015)
# theme_economist()
# theme_fivethirtyeight()
# theme_bw()
library("corrplot")
joined_data_all_final_LRM
names(joined_data_all_final_LRM)
joined_data_all_final_LRM
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
joined_data_all_final_LRM
joined_data_all_final_LRM[, 5:12]
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
# The final dataset for modelling purpose
joined_data_all_final_LRM <- joined_data_all_final %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015) %>% rename(
age_adjusted_death_rate = "stroke_mort",
total_below_poverty_level_per_capita = "below_poverty",
total_without_health_ins_per_capita = "no_health_ins",
income_001 = "median_income",
age_adjusted_incidence_rate_cases_per_100_000 = "incidence",
trend_falling = "incidence_falling",
trend_rising = "incidence_rising",
popestimate2015 = "population"
)
# The final dataset for modelling purpose
joined_data_all_final_LRM <- joined_data_all_final %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015) %>% rename(
age_adjusted_death_rate = "stroke_mort",
total_below_poverty_level_per_capita = "below_poverty",
total_without_health_ins_per_capita = "no_health_ins",
income_001 = "median_income",
age_adjusted_incidence_rate_cases_per_100_000 = "incidence",
trend_falling = "incidence_falling",
trend_rising = "incidence_rising",
popestimate2015 = "population"
)
# The final dataset for modelling purpose
joined_data_all_final_LRM <- joined_data_all_final %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015) %>% rename(
stroke_mort = "age_adjusted_death_rate",
total_below_poverty_level_per_capita = "below_poverty",
total_without_health_ins_per_capita = "no_health_ins",
income_001 = "median_income",
age_adjusted_incidence_rate_cases_per_100_000 = "incidence",
trend_falling = "incidence_falling",
trend_rising = "incidence_rising",
popestimate2015 = "population"
)
# The final dataset for modelling purpose
joined_data_all_final_LRM <- joined_data_all_final %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015) %>% rename(
stroke_mort = "age_adjusted_death_rate",
below_poverty = "total_below_poverty_level_per_capita",
no_health_ins = "total_without_health_ins_per_capita",
median_income = "income_001",
incidence = "age_adjusted_incidence_rate_cases_per_100_000",
incidence_falling = "trend_falling",
incidence_rising = "trend_rising",
population = "popestimate2015"
)
joined_data_all_final_LRM
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
# Incidence rate (Age-Adjusted Incidence Rate - cases per 100,000)
# [Uncertainty: only for aged 75 and above?]
# Check incidence rate by state
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# Zero for KS and MN, check
joined_data_all_final %>% filter(state %in% c("KS", "MN")) %>% describe() # Incidence data is missing for KS and MN
# Remove Ks and MN rows
joined_data_all_final <- joined_data_all_final %>% filter(!state %in% c("KS", "MN"))
summary_incidence_by_state <- joined_data_all_final %>%
group_by(state) %>%
summarise(incidence_rate_per_100000 = sum(age_adjusted_incidence_rate_cases_per_100_000 * popestimate2015) / sum(popestimate2015) )
summary_incidence_by_state %>%
ggplot(aes(state, incidence_rate_per_100000, fill = state)) +
geom_col(show.legend = F) +
theme_economist()
# The final dataset for modelling purpose
joined_data_all_final_LRM <- joined_data_all_final %>% select(county_name,
state_name,
state,
fips_clean,
age_adjusted_death_rate,
total_below_poverty_level_per_capita,
total_without_health_ins_per_capita,
income_001,
age_adjusted_incidence_rate_cases_per_100_000,
trend_falling,
trend_rising,
popestimate2015) %>% rename(
stroke_mort = "age_adjusted_death_rate",
below_poverty = "total_below_poverty_level_per_capita",
no_health_ins = "total_without_health_ins_per_capita",
median_income = "income_001",
incidence = "age_adjusted_incidence_rate_cases_per_100_000",
incidence_falling = "trend_falling",
incidence_rising = "trend_rising",
population = "popestimate2015"
)
corrplot(cor(joined_data_all_final_LRM[, 5:12], use="pairwise.complete.obs"))
